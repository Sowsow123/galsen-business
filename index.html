<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galsen Business - Plateforme de Visionnage Rémunéré</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2ecc71;
            --primary-dark: #27ae60;
            --secondary: #3498db;
            --orange: #e67e22;
            --red: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --gray: #95a5a6;
            --dark-gray: #7f8c8d;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, var(--dark), var(--primary-dark));
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .logo i {
            color: var(--primary);
        }
        
        /* Navigation */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            padding: 5px 10px;
            border-radius: 4px;
        }
        
        .nav-links a:hover {
            background-color: rgba(255,255,255,0.1);
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .card-title {
            font-size: 1.25rem;
            margin-bottom: 15px;
            color: var(--dark);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 8px;
            display: inline-block;
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, select, textarea, button {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2);
        }
        
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .btn-orange {
            background: var(--orange);
        }
        
        .btn-orange:hover {
            background: #d35400;
        }
        
        .btn-secondary {
            background: var(--secondary);
        }
        
        .btn-secondary:hover {
            background: #2980b9;
        }
        
        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--dark);
            margin: 10px 0;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .data-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .data-table tr:hover {
            background-color: #f1f1f1;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .badge-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .badge-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .badge-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Alert */
        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        
        .alert-warning {
            background-color: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }
        
        /* Video Player */
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            margin-bottom: 20px;
            border-radius: 8px;
            background: #000;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* Footer */
        .footer {
            background: var(--dark);
            color: white;
            padding: 30px 0;
            margin-top: 50px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
        }
        
        .footer-section h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .footer-section ul {
            list-style: none;
        }
        
        .footer-section ul li {
            margin-bottom: 8px;
        }
        
        .footer-section ul li a {
            color: #bdc3c7;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-section ul li a:hover {
            color: white;
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            margin-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
            color: #bdc3c7;
        }
        
        /* Dark Mode */
        body.dark-mode {
            background-color: #121212;
            color: #f1f1f1;
        }
        
        .dark-mode .card,
        .dark-mode .stat-card {
            background: #1e1e1e;
            color: #f1f1f1;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        
        .dark-mode .data-table th {
            background-color: var(--primary-dark);
        }
        
        .dark-mode .data-table tr {
            background-color: #2d2d2d;
            color: #f1f1f1;
        }
        
        .dark-mode .data-table tr:nth-child(even) {
            background-color: #252525;
        }
        
        .dark-mode .data-table tr:hover {
            background-color: #333;
        }
        
        .dark-mode input,
        .dark-mode select,
        .dark-mode textarea {
            background-color: #2d2d2d;
            border-color: #444;
            color: #f1f1f1;
        }
        
        .dark-mode label {
            color: #f1f1f1;
        }
        
        .dark-mode .card-title {
            color: #f1f1f1;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 70px;
                left: 0;
                right: 0;
                background: var(--dark);
                flex-direction: column;
                padding: 20px;
                gap: 15px;
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <i class="fas fa-coins"></i>
                    <span>Galsen Business</span>
                </div>
                
                <div class="nav-links" id="navLinks">
                    <a href="#" id="homeLink">Accueil</a>
                    <a href="#" id="dashboardLink">Tableau de Bord</a>
                    <a href="#" id="depositLink">Dépôt</a>
                    <a href="#" id="withdrawLink">Retrait</a>
                    <a href="#" id="referralLink">Parrainage</a>
                    <a href="#" id="helpLink">Aide</a>
                    <a href="#" id="loginLink">Connexion</a>
                    <a href="#" id="registerLink">Inscription</a>
                    <a href="#" id="logoutLink" style="display:none;">Déconnexion</a>
                </div>
                
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Login Section -->
        <section id="loginSection" class="card" style="max-width: 500px; margin: 50px auto;">
            <h2 class="card-title">Connexion à votre compte</h2>
            <div id="loginAlert" class="alert" style="display: none;"></div>
            
            <div class="form-group">
                <label for="loginEmail"><i class="fas fa-envelope"></i> Adresse Email</label>
                <input type="email" id="loginEmail" placeholder="votre@email.com" required>
            </div>
            
            <div class="form-group">
                <label for="loginPassword"><i class="fas fa-lock"></i> Mot de passe</label>
                <input type="password" id="loginPassword" placeholder="••••••••" minlength="6" required>
            </div>
            
            <div class="form-group" style="text-align: right;">
                <a href="#" id="forgotPasswordLink" style="color: var(--primary); text-decoration: none;">Mot de passe oublié ?</a>
            </div>
            
            <button class="btn" onclick="loginUser()">
                <i class="fas fa-sign-in-alt"></i> Se connecter
            </button>
            
            <div style="text-align: center; margin-top: 20px;">
                <p>Pas encore de compte ? <a href="#" onclick="showRegister()" style="color: var(--primary); text-decoration: none;">S'inscrire</a></p>
            </div>
        </section>

        <!-- Register Section -->
        <section id="registerSection" class="card" style="max-width: 500px; margin: 50px auto; display: none;">
            <h2 class="card-title">Créer un compte</h2>
            <div id="registerAlert" class="alert" style="display: none;"></div>
            
            <div class="form-group">
                <label for="regName"><i class="fas fa-user"></i> Nom complet</label>
                <input type="text" id="regName" placeholder="Votre nom complet" required>
            </div>
            
            <div class="form-group">
                <label for="regEmail"><i class="fas fa-envelope"></i> Adresse Email</label>
                <input type="email" id="regEmail" placeholder="votre@email.com" required>
            </div>
            
            <div class="form-group">
                <label for="regPhone"><i class="fas fa-phone"></i> Numéro de téléphone (Sénégal)</label>
                <input type="tel" id="regPhone" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                <small style="color: var(--gray);">Format: 77xxxxxxx, 76xxxxxxx ou 78xxxxxxx</small>
            </div>
            
            <div class="form-group">
                <label for="regPassword"><i class="fas fa-lock"></i> Mot de passe</label>
                <input type="password" id="regPassword" placeholder="••••••••" minlength="6" required>
                <small style="color: var(--gray);">Minimum 6 caractères</small>
            </div>
            
            <div class="form-group">
                <label for="regConfirmPassword"><i class="fas fa-lock"></i> Confirmer le mot de passe</label>
                <input type="password" id="regConfirmPassword" placeholder="••••••••" minlength="6" required>
            </div>
            
            <div class="form-group">
                <label for="referralCode"><i class="fas fa-user-plus"></i> Code de parrainage (optionnel)</label>
                <input type="text" id="referralCode" placeholder="Code d'un parrain">
            </div>
            
            <button class="btn" onclick="registerUser()">
                <i class="fas fa-user-plus"></i> S'inscrire
            </button>
            
            <div style="text-align: center; margin-top: 20px;">
                <p>Déjà inscrit ? <a href="#" onclick="showLogin()" style="color: var(--primary); text-decoration: none;">Se connecter</a></p>
            </div>
        </section>

        <!-- Main Dashboard (Visible when logged in) -->
        <section id="mainContent" style="display: none;">
            <div class="welcome-banner">
                <h1>Bienvenue, <span id="userGreeting"></span> !</h1>
                <p>Commencez à gagner de l'argent en regardant des vidéos</p>
            </div>
            
            <!-- User Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <div class="stat-value" id="userBalance">0 XOF</div>
                    <div class="stat-label">Solde disponible</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="stat-value" id="userLevel">1</div>
                    <div class="stat-label">Niveau actuel</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="stat-value" id="todayEarnings">0 XOF</div>
                    <div class="stat-label">Gains aujourd'hui</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-value" id="totalReferrals">0</div>
                    <div class="stat-label">Filleuls actifs</div>
                </div>
            </div>
            
            <!-- Videos Section -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-play-circle"></i> Vidéos à regarder</h2>
                
                <div class="tabs">
                    <div class="tab active" onclick="switchVideoTab('youtube')">YouTube</div>
                    <div class="tab" onclick="switchVideoTab('tiktok')">TikTok</div>
                </div>
                
                <div id="youtubeTab" class="tab-content active">
                    <p>Regardez 2 vidéos YouTube par jour et gagnez <strong id="youtubeEarningRate">100 XOF</strong> par vidéo.</p>
                    
                    <div id="youtubeVideo1" class="video-container" style="display: none;">
                        <!-- Video iframe will be loaded here -->
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <button id="youtubeBtn1" class="btn" onclick="startWatchingVideo('youtube', 1)">
                            <i class="fab fa-youtube"></i> Regarder la vidéo 1
                        </button>
                        <p id="youtubeStatus1" style="margin-top: 10px;"></p>
                    </div>
                    
                    <div id="youtubeVideo2" class="video-container" style="display: none;">
                        <!-- Video iframe will be loaded here -->
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <button id="youtubeBtn2" class="btn" onclick="startWatchingVideo('youtube', 2)" disabled>
                            <i class="fab fa-youtube"></i> Regarder la vidéo 2
                        </button>
                        <p id="youtubeStatus2" style="margin-top: 10px;"></p>
                    </div>
                </div>
                
                <div id="tiktokTab" class="tab-content">
                    <p>Regardez 1 vidéo TikTok par jour et gagnez <strong id="tiktokEarningRate">100 XOF</strong>.</p>
                    
                    <div id="tiktokVideo" class="video-container" style="display: none;">
                        <!-- Video iframe will be loaded here -->
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <button id="tiktokBtn" class="btn" onclick="startWatchingVideo('tiktok', 1)">
                            <i class="fab fa-tiktok"></i> Regarder la vidéo
                        </button>
                        <p id="tiktokStatus" style="margin-top: 10px;"></p>
                    </div>
                </div>
            </div>
            
            <!-- Deposit Section -->
            <div class="card" id="depositSection">
                <h2 class="card-title"><i class="fas fa-money-bill-wave"></i> Dépôt d'argent</h2>
                <p>Effectuez un dépôt pour augmenter votre niveau et vos gains par vidéo.</p>
                <p>Minimum: <strong style="color: var(--orange);">1 000 XOF</strong></p>
                
                <div class="form-group">
                    <label for="depositAmount"><i class="fas fa-money-bill-alt"></i> Montant (XOF)</label>
                    <input type="number" id="depositAmount" placeholder="1000" min="1000" required>
                </div>
                
                <div class="form-group">
                    <label for="depositMethod"><i class="fas fa-mobile-alt"></i> Méthode de paiement</label>
                    <select id="depositMethod" onchange="updateDepositMethod()">
                        <option value="orange">Orange Money</option>
                        <option value="wave">Wave</option>
                        <option value="free">Free Money</option>
                    </select>
                </div>
                
                <div id="orangeDeposit" class="deposit-method">
                    <div class="form-group">
                        <label for="orangeNumber"><i class="fas fa-phone"></i> Numéro Orange Money</label>
                        <input type="tel" id="orangeNumber" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                    </div>
                    
                    <button class="btn btn-orange" onclick="processDeposit('orange')">
                        <i class="fas fa-paper-plane"></i> Déposer via Orange Money
                    </button>
                </div>
                
                <div id="waveDeposit" class="deposit-method" style="display: none;">
                    <div class="form-group">
                        <label><i class="fas fa-qrcode"></i> Scanner le QR Code Wave</label>
                        <img src="wave-qr.png" alt="QR Code Wave" style="max-width: 200px; display: block; margin: 10px auto; border: 1px solid #ddd; padding: 10px; background: white;">
                    </div>
                    
                    <div class="form-group">
                        <label for="waveTransactionId"><i class="fas fa-receipt"></i> ID de transaction Wave</label>
                        <input type="text" id="waveTransactionId" placeholder="ID de transaction après paiement" required>
                    </div>
                    
                    <button class="btn btn-secondary" onclick="processDeposit('wave')">
                        <i class="fas fa-check-circle"></i> Confirmer le paiement
                    </button>
                </div>
                
                <div id="freeDeposit" class="deposit-method" style="display: none;">
                    <div class="form-group">
                        <label for="freeNumber"><i class="fas fa-phone"></i> Numéro Free Money</label>
                        <input type="tel" id="freeNumber" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                    </div>
                    
                    <button class="btn" style="background: #1a73e8;" onclick="processDeposit('free')">
                        <i class="fas fa-paper-plane"></i> Déposer via Free Money
                    </button>
                </div>
                
                <div id="depositStatus" style="margin-top: 20px;"></div>
            </div>
            
            <!-- Withdrawal Section -->
            <div class="card" id="withdrawalSection">
                <h2 class="card-title"><i class="fas fa-hand-holding-usd"></i> Retrait d'argent</h2>
                <p>Retirez vos gains facilement sur votre compte mobile.</p>
                <p>Minimum de retrait: <strong style="color: var(--orange);">500 XOF</strong></p>
                
                <div class="form-group">
                    <label for="withdrawAmount"><i class="fas fa-money-bill-alt"></i> Montant (XOF)</label>
                    <input type="number" id="withdrawAmount" placeholder="500" min="500" required>
                </div>
                
                <div class="form-group">
                    <label for="withdrawMethod"><i class="fas fa-mobile-alt"></i> Méthode de retrait</label>
                    <select id="withdrawMethod" onchange="updateWithdrawMethod()">
                        <option value="orange">Orange Money</option>
                        <option value="wave">Wave</option>
                        <option value="free">Free Money</option>
                    </select>
                </div>
                
                <div id="orangeWithdraw" class="withdraw-method">
                    <div class="form-group">
                        <label for="withdrawOrangeNumber"><i class="fas fa-phone"></i> Numéro Orange Money</label>
                        <input type="tel" id="withdrawOrangeNumber" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                    </div>
                </div>
                
                <div id="waveWithdraw" class="withdraw-method" style="display: none;">
                    <div class="form-group">
                        <label for="withdrawWaveNumber"><i class="fas fa-phone"></i> Numéro Wave</label>
                        <input type="tel" id="withdrawWaveNumber" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                    </div>
                </div>
                
                <div id="freeWithdraw" class="withdraw-method" style="display: none;">
                    <div class="form-group">
                        <label for="withdrawFreeNumber"><i class="fas fa-phone"></i> Numéro Free Money</label>
                        <input type="tel" id="withdrawFreeNumber" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                    </div>
                </div>
                
                <button class="btn btn-orange" onclick="requestWithdrawal()">
                    <i class="fas fa-paper-plane"></i> Demander le retrait
                </button>
                
                <div id="withdrawalStatus" style="margin-top: 20px;"></div>
            </div>
            
            <!-- Referral Section -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-user-friends"></i> Programme de parrainage</h2>
                <p>Gagnez <strong style="color: var(--primary);">10%</strong> sur les dépôts de vos filleuls après avoir parrainé <strong>10 personnes</strong>.</p>
                
                <div class="form-group">
                    <label><i class="fas fa-link"></i> Votre lien de parrainage</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="referralLink" readonly style="flex: 1;">
                        <button class="btn" onclick="copyReferralLink()" style="width: auto; padding: 0 15px;">
                            <i class="fas fa-copy"></i> Copier
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-users"></i> Vos filleuls</label>
                    <div id="referralList" style="border: 1px solid #ddd; border-radius: 6px; padding: 10px; max-height: 200px; overflow-y: auto;">
                        <p style="color: var(--gray); text-align: center;">Aucun filleul pour le moment</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-coins"></i> Gains de parrainage</label>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>Total gagné:</span>
                            <strong id="referralEarnings">0 XOF</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <span>En attente:</span>
                            <strong id="pendingReferralEarnings">0 XOF</strong>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Admin Dashboard -->
        <section id="adminDashboard" style="display: none;">
            <div class="welcome-banner">
                <h1><i class="fas fa-tachometer-alt"></i> Tableau de Bord Administrateur</h1>
                <p>Gestion complète de la plateforme Galsen Business</p>
            </div>
            
            <!-- Admin Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-value" id="totalEarnings">0 XOF</div>
                    <div class="stat-label">Bénéfices totaux</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">Utilisateurs actifs</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <div class="stat-value" id="totalTransactions">0</div>
                    <div class="stat-label">Transactions</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-value" id="pendingWithdrawals">0</div>
                    <div class="stat-label">Retraits en attente</div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-bolt"></i> Actions rapides</h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <button class="btn" onclick="showTab('adminWithdrawTab')">
                        <i class="fas fa-money-bill-wave"></i> Retrait admin
                    </button>
                    
                    <button class="btn btn-secondary" onclick="showTab('manageUsersTab')">
                        <i class="fas fa-user-cog"></i> Gérer les utilisateurs
                    </button>
                    
                    <button class="btn btn-orange" onclick="showTab('withdrawalRequestsTab')">
                        <i class="fas fa-list-ul"></i> Demandes de retrait
                    </button>
                    
                    <button class="btn" style="background: var(--red);" onclick="showTab('systemSettingsTab')">
                        <i class="fas fa-cog"></i> Paramètres système
                    </button>
                </div>
            </div>
            
            <!-- Admin Tabs -->
            <div class="tabs">
                <div class="tab active" onclick="showTab('adminWithdrawTab')">Retrait Admin</div>
                <div class="tab" onclick="showTab('withdrawalRequestsTab')">Demandes de retrait</div>
                <div class="tab" onclick="showTab('manageUsersTab')">Gestion utilisateurs</div>
                <div class="tab" onclick="showTab('systemSettingsTab')">Paramètres</div>
            </div>
            
            <!-- Admin Withdrawal Tab -->
            <div id="adminWithdrawTab" class="tab-content active">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-money-bill-wave"></i> Retrait des bénéfices</h2>
                    
                    <div class="form-group">
                        <label for="adminWithdrawAmount"><i class="fas fa-money-bill-alt"></i> Montant (XOF)</label>
                        <input type="number" id="adminWithdrawAmount" placeholder="5000" min="1000" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="adminWithdrawMethod"><i class="fas fa-mobile-alt"></i> Méthode de retrait</label>
                        <select id="adminWithdrawMethod" onchange="updateAdminWithdrawMethod()">
                            <option value="orange">Orange Money</option>
                            <option value="wave">Wave</option>
                            <option value="free">Free Money</option>
                        </select>
                    </div>
                    
                    <div id="adminOrangeWithdraw" class="withdraw-method">
                        <div class="form-group">
                            <label for="adminOrangeNumber"><i class="fas fa-phone"></i> Numéro Orange Money</label>
                            <input type="tel" id="adminOrangeNumber" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                        </div>
                    </div>
                    
                    <div id="adminWaveWithdraw" class="withdraw-method" style="display: none;">
                        <div class="form-group">
                            <label><i class="fas fa-qrcode"></i> QR Code Wave</label>
                            <img src="admin-wave-qr.png" alt="QR Code Wave Admin" style="max-width: 200px; display: block; margin: 10px auto; border: 1px solid #ddd; padding: 10px; background: white;">
                        </div>
                        
                        <div class="form-group">
                            <label for="adminWaveTransactionId"><i class="fas fa-receipt"></i> ID de transaction</label>
                            <input type="text" id="adminWaveTransactionId" placeholder="ID de transaction après paiement" required>
                        </div>
                    </div>
                    
                    <div id="adminFreeWithdraw" class="withdraw-method" style="display: none;">
                        <div class="form-group">
                            <label for="adminFreeNumber"><i class="fas fa-phone"></i> Numéro Free Money</label>
                            <input type="tel" id="adminFreeNumber" placeholder="77xxxxxxx" pattern="[0-9]{9}" required>
                        </div>
                    </div>
                    
                    <button class="btn btn-orange" onclick="processAdminWithdrawal()">
                        <i class="fas fa-paper-plane"></i> Effectuer le retrait
                    </button>
                    
                    <div id="adminWithdrawStatus" style="margin-top: 20px;"></div>
                </div>
                
                <!-- Automatic Orange Money Withdrawal Settings -->
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-robot"></i> Retraits automatiques Orange Money</h2>
                    
                    <div class="form-group">
                        <label for="autoWithdrawEnabled">
                            <input type="checkbox" id="autoWithdrawEnabled" onchange="toggleAutoWithdraw()">
                            Activer les retraits automatiques
                        </label>
                    </div>
                    
                    <div id="autoWithdrawSettings" style="display: none;">
                        <div class="form-group">
                            <label for="autoWithdrawMinAmount"><i class="fas fa-money-bill-alt"></i> Montant minimum (XOF)</label>
                            <input type="number" id="autoWithdrawMinAmount" placeholder="500" min="100" value="500">
                        </div>
                        
                        <div class="form-group">
                            <label for="autoWithdrawMaxAmount"><i class="fas fa-money-bill-alt"></i> Montant maximum (XOF)</label>
                            <input type="number" id="autoWithdrawMaxAmount" placeholder="100000" min="500" value="50000">
                        </div>
                        
                        <div class="form-group">
                            <label for="autoWithdrawPhone"><i class="fas fa-phone"></i> Numéro Orange Money</label>
                            <input type="tel" id="autoWithdrawPhone" placeholder="77xxxxxxx" pattern="[0-9]{9}">
                        </div>
                        
                        <button class="btn" onclick="saveAutoWithdrawSettings()">
                            <i class="fas fa-save"></i> Enregistrer les paramètres
                        </button>
                    </div>
                    
                    <div id="autoWithdrawStatus" style="margin-top: 20px;"></div>
                </div>
            </div>
            
            <!-- Withdrawal Requests Tab -->
            <div id="withdrawalRequestsTab" class="tab-content">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-list-ul"></i> Demandes de retrait en attente</h2>
                    
                    <div class="form-group">
                        <input type="text" id="withdrawalSearch" placeholder="Rechercher par nom, numéro ou montant..." oninput="filterWithdrawals()">
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Utilisateur</th>
                                    <th>Montant</th>
                                    <th>Méthode</th>
                                    <th>Numéro</th>
                                    <th>Date</th>
                                    <th>Statut</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="withdrawalRequests">
                                <!-- Will be populated dynamically -->
                                <tr>
                                    <td colspan="8" style="text-align: center;">Aucune demande de retrait en attente</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Manage Users Tab -->
            <div id="manageUsersTab" class="tab-content">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-user-cog"></i> Gestion des utilisateurs</h2>
                    
                    <div class="form-group">
                        <input type="text" id="userSearch" placeholder="Rechercher par nom, email ou téléphone..." oninput="filterUsers()">
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Email</th>
                                    <th>Téléphone</th>
                                    <th>Solde</th>
                                    <th>Niveau</th>
                                    <th>Inscription</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="usersList">
                                <!-- Will be populated dynamically -->
                                <tr>
                                    <td colspan="8" style="text-align: center;">Aucun utilisateur trouvé</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- System Settings Tab -->
            <div id="systemSettingsTab" class="tab-content">
                <div class="card">
                    <h2 class="card-title"><i class="fas fa-cog"></i> Paramètres système</h2>
                    
                    <div class="form-group">
                        <label for="systemName">Nom du système</label>
                        <input type="text" id="systemName" placeholder="Galsen Business" value="Galsen Business">
                    </div>
                    
                    <div class="form-group">
                        <label for="adminEmail">Email admin</label>
                        <input type="email" id="adminEmail" placeholder="admin@galsenbusiness.com" value="admin@galsenbusiness.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="contactPhone">Téléphone de contact</label>
                        <input type="tel" id="contactPhone" placeholder="77xxxxxxx" pattern="[0-9]{9}">
                    </div>
                    
                    <div class="form-group">
                        <label for="earningRates">Taux de gains par niveau (XOF)</label>
                        <div id="earningRates" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                            <!-- Will be populated dynamically -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="depositMinAmount">Dépôt minimum (XOF)</label>
                        <input type="number" id="depositMinAmount" placeholder="1000" min="100" value="1000">
                    </div>
                    
                    <div class="form-group">
                        <label for="withdrawMinAmount">Retrait minimum (XOF)</label>
                        <input type="number" id="withdrawMinAmount" placeholder="500" min="100" value="500">
                    </div>
                    
                    <button class="btn" onclick="saveSystemSettings()">
                        <i class="fas fa-save"></i> Enregistrer les paramètres
                    </button>
                    
                    <div id="systemSettingsStatus" style="margin-top: 20px;"></div>
                </div>
            </div>
        </section>
        
        <!-- Help Section -->
        <section id="helpSection" class="card" style="display: none; max-width: 800px; margin: 20px auto;">
            <h2 class="card-title"><i class="fas fa-question-circle"></i> Centre d'aide</h2>
            
            <div class="tabs">
                <div class="tab active" onclick="switchHelpTab('howItWorks')">Comment ça marche</div>
                <div class="tab" onclick="switchHelpTab('faq')">FAQ</div>
                <div class="tab" onclick="switchHelpTab('contact')">Contact</div>
            </div>
            
            <div id="howItWorksTab" class="tab-content active">
                <h3 style="margin: 20px 0 10px;"><i class="fas fa-play"></i> Tutoriel vidéo</h3>
                <div class="video-container">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/VIDEO_ID" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                
                <h3 style="margin: 20px 0 10px;"><i class="fas fa-list-ol"></i> Étapes pour commencer</h3>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                    <div style="display: flex; margin-bottom: 15px;">
                        <div style="background: var(--primary); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px;">1</div>
                        <div>
                            <strong>Créez votre compte</strong>
                            <p>Inscrivez-vous avec votre email et numéro de téléphone Sénégalais</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; margin-bottom: 15px;">
                        <div style="background: var(--primary); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px;">2</div>
                        <div>
                            <strong>Effectuez un dépôt</strong>
                            <p>Minimum 1 000 XOF via Orange Money, Wave ou Free Money</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; margin-bottom: 15px;">
                        <div style="background: var(--primary); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px;">3</div>
                        <div>
                            <strong>Regardez des vidéos</strong>
                            <p>2 vidéos YouTube et 1 vidéo TikTok par jour pour gagner de l'argent</p>
                        </div>
                    </div>
                    
                    <div style="display: flex;">
                        <div style="background: var(--primary); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px;">4</div>
                        <div>
                            <strong>Retirez vos gains</strong>
                            <p>Retrait automatique vers Orange Money, Wave ou Free Money</p>
                        </div>
                    </div>
                </div>
                
                <h3 style="margin: 20px 0 10px;"><i class="fas fa-chart-line"></i> Niveaux et gains</h3>
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Niveau</th>
                                <th>Dépôt minimum</th>
                                <th>Gain/vidéo YouTube</th>
                                <th>Gain/vidéo TikTok</th>
                            </tr>
                        </thead>
                        <tbody id="levelsTable">
                            <tr><td>1</td><td>1,000 XOF</td><td>100 XOF</td><td>100 XOF</td></tr>
                            <tr><td>2</td><td>2,000 XOF</td><td>200 XOF</td><td>200 XOF</td></tr>
                            <tr><td>3</td><td>3,000 XOF</td><td>300 XOF</td><td>300 XOF</td></tr>
                            <tr><td>4</td><td>4,000 XOF</td><td>400 XOF</td><td>400 XOF</td></tr>
                            <tr><td>5</td><td>5,000 XOF</td><td>500 XOF</td><td>500 XOF</td></tr>
                            <tr><td>6</td><td>6,000 XOF</td><td>600 XOF</td><td>600 XOF</td></tr>
                            <tr><td>7</td><td>7,000 XOF</td><td>700 XOF</td><td>700 XOF</td></tr>
                            <tr><td>8</td><td>8,000 XOF</td><td>800 XOF</td><td>800 XOF</td></tr>
                            <tr><td>9</td><td>9,000 XOF</td><td>900 XOF</td><td>900 XOF</td></tr>
                            <tr><td>10</td><td>10,000 XOF</td><td>1,000 XOF</td><td>1,000 XOF</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="faqTab" class="tab-content">
                <h3 style="margin: 20px 0 10px;"><i class="fas fa-question"></i> Questions fréquentes</h3>
                
                <div class="faq-item" style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 5px; cursor: pointer;" onclick="toggleFaqAnswer(this)">
                        <i class="fas fa-chevron-right" style="margin-right: 5px;"></i>
                        Comment puis-je gagner de l'argent sur Galsen Business ?
                    </div>
                    <div class="faq-answer" style="display: none; padding-left: 20px; color: var(--gray);">
                        Vous gagnez de l'argent en regardant des vidéos (2 vidéos YouTube et 1 vidéo TikTok par jour). Le montant gagné dépend de votre niveau, qui est déterminé par le montant total que vous avez déposé.
                    </div>
                </div>
                
                <div class="faq-item" style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 5px; cursor: pointer;" onclick="toggleFaqAnswer(this)">
                        <i class="fas fa-chevron-right" style="margin-right: 5px;"></i>
                        Quand puis-je retirer mon argent ?
                    </div>
                    <div class="faq-answer" style="display: none; padding-left: 20px; color: var(--gray);">
                        Vous pouvez demander un retrait à tout moment dès que votre solde atteint 500 XOF. Les retraits sont traités dans les 24 heures.
                    </div>
                </div>
                
                <div class="faq-item" style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 5px; cursor: pointer;" onclick="toggleFaqAnswer(this)">
                        <i class="fas fa-chevron-right" style="margin-right: 5px;"></i>
                        Comment fonctionne le programme de parrainage ?
                    </div>
                    <div class="faq-answer" style="display: none; padding-left: 20px; color: var(--gray);">
                        Lorsque vous parrainez quelqu'un, vous gagnez 10% sur ses dépôts après avoir parrainé 10 personnes. Partagez simplement votre lien de parrainage avec vos amis.
                    </div>
                </div>
                
                <div class="faq-item" style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 5px; cursor: pointer;" onclick="toggleFaqAnswer(this)">
                        <i class="fas fa-chevron-right" style="margin-right: 5px;"></i>
                        Pourquoi dois-je effectuer un dépôt ?
                    </div>
                    <div class="faq-answer" style="display: none; padding-left: 20px; color: var(--gray);">
                        Le dépôt initial (minimum 1 000 XOF) permet de vérifier la validité de votre compte et détermine votre niveau de gains. Plus vous déposez, plus vos gains par vidéo augmentent.
                    </div>
                </div>
            </div>
            
            <div id="contactTab" class="tab-content">
                <h3 style="margin: 20px 0 10px;"><i class="fas fa-envelope"></i> Contactez-nous</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                        <h4 style="margin-bottom: 10px;"><i class="fas fa-envelope"></i> Email</h4>
                        <p>Pour toute question ou assistance :</p>
                        <a href="mailto:msow93062@gmail.com" style="color: var(--primary);">msow93062@gmail.com</a>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                        <h4 style="margin-bottom: 10px;"><i class="fas fa-phone"></i> Téléphone</h4>
                        <p>Service client disponible :</p>
                        <a href="tel:+221771234567" style="color: var(--primary);">+221 77 123 45 67</a>
                        <p style="margin-top: 5px; font-size: 0.9rem;">9h-18h, Lundi-Vendredi</p>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                    <h4 style="margin-bottom: 10px;"><i class="fas fa-map-marker-alt"></i> Adresse</h4>
                    <p>Galsen Business</p>
                    <p>Dakar, Sénégal</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Galsen Business</h3>
                    <p>Plateforme de visionnage rémunéré leader au Sénégal. Gagnez de l'argent simplement en regardant des vidéos.</p>
                </div>
                
                <div class="footer-section">
                    <h3>Liens rapides</h3>
                    <ul>
                        <li><a href="#" onclick="showHelp()">Comment ça marche</a></li>
                        <li><a href="#" onclick="showRegister()">S'inscrire</a></li>
                        <li><a href="#" onclick="showLogin()">Se connecter</a></li>
                        <li><a href="#" onclick="showHelp()">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Méthodes de paiement</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-money-bill-wave"></i> Orange Money</a></li>
                        <li><a href="#"><i class="fas fa-qrcode"></i> Wave</a></li>
                        <li><a href="#"><i class="fas fa-mobile-alt"></i> Free Money</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Nous contacter</h3>
                    <ul>
                        <li><a href="mailto:msow93062@gmail.com"><i class="fas fa-envelope"></i> msow93062@gmail.com</a></li>
                        <li><a href="tel:+221771234567"><i class="fas fa-phone"></i> +221 77 123 45 67</a></li>
                        <li>
                            <div style="display: flex; gap: 15px; margin-top: 10px;">
                                <a href="#" style="color: white; font-size: 1.2rem;"><i class="fab fa-facebook"></i></a>
                                <a href="#" style="color: white; font-size: 1.2rem;"><i class="fab fa-instagram"></i></a>
                                <a href="#" style="color: white; font-size: 1.2rem;"><i class="fab fa-twitter"></i></a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2023 Galsen Business. Tous droits réservés.</p>
            </div>
        </div>
    </footer>

    <script>
        // Data storage (simplified for demo - replace with database in production)
        let users = JSON.parse(localStorage.getItem('galsenBusinessUsers')) || [];
        let currentUser = JSON.parse(sessionStorage.getItem('galsenBusinessCurrentUser')) || null;
        let deposits = JSON.parse(localStorage.getItem('galsenBusinessDeposits')) || [];
        let withdrawals = JSON.parse(localStorage.getItem('galsenBusinessWithdrawals')) || [];
        let videosWatched = JSON.parse(localStorage.getItem('galsenBusinessVideosWatched')) || { youtube: 0, tiktok: 0 };
        let lastVideoDate = localStorage.getItem('galsenBusinessLastVideoDate') ? new Date(localStorage.getItem('galsenBusinessLastVideoDate')) : null;
        let systemSettings = JSON.parse(localStorage.getItem('galsenBusinessSettings')) || {
            earningRates: [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
            depositMin: 1000,
            withdrawMin: 500,
            autoWithdraw: false
        };
        
        // Admin credentials (change in production!)
        const ADMIN_CREDENTIALS = {
            email: "admin@galsenbusiness.com",
            password: "AdminSecure123!" // Change this!
        };
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Check login status
            checkLoginStatus();
            
            // Check if it's a new day for video watching
            checkNewDay();
            
            // Load system settings
            loadSystemSettings();
            
            // Setup event listeners
            setupEventListeners();
            
            // Check for dark mode preference
            if (localStorage.getItem('galsenBusinessDarkMode') === 'true') {
                document.body.classList.add('dark-mode');
            }
        });
        
        function setupEventListeners() {
            // Navigation links
            document.getElementById('homeLink').addEventListener('click', function(e) {
                e.preventDefault();
                if (currentUser) {
                    showMainContent();
                } else {
                    showLogin();
                }
            });
            
            document.getElementById('dashboardLink').addEventListener('click', function(e) {
                e.preventDefault();
                if (currentUser) {
                    if (currentUser.email === ADMIN_CREDENTIALS.email) {
                        showAdminDashboard();
                    } else {
                        showMainContent();
                    }
                } else {
                    showLogin();
                }
            });
            
            document.getElementById('loginLink').addEventListener('click', function(e) {
                e.preventDefault();
                showLogin();
            });
            
            document.getElementById('registerLink').addEventListener('click', function(e) {
                e.preventDefault();
                showRegister();
            });
            
            document.getElementById('depositLink').addEventListener('click', function(e) {
                e.preventDefault();
                if (currentUser) {
                    showMainContent();
                    setTimeout(() => {
                        document.getElementById('depositSection').scrollIntoView({ behavior: 'smooth' });
                    }, 100);
                } else {
                    showLogin();
                }
            });
            
            document.getElementById('withdrawLink').addEventListener('click', function(e) {
                e.preventDefault();
                if (currentUser) {
                    showMainContent();
                    setTimeout(() => {
                        document.getElementById('withdrawalSection').scrollIntoView({ behavior: 'smooth' });
                    }, 100);
                } else {
                    showLogin();
                }
            });
            
            document.getElementById('referralLink').addEventListener('click', function(e) {
                e.preventDefault();
                if (currentUser) {
                    showMainContent();
                    setTimeout(() => {
                        document.querySelector('.card:nth-child(4)').scrollIntoView({ behavior: 'smooth' });
                    }, 100);
                } else {
                    showLogin();
                }
            });
            
            document.getElementById('helpLink').addEventListener('click', function(e) {
                e.preventDefault();
                showHelp();
            });
            
            document.getElementById('logoutLink').addEventListener('click', function(e) {
                e.preventDefault();
                logoutUser();
            });
            
            // Forgot password
            document.getElementById('forgotPasswordLink').addEventListener('click', function(e) {
                e.preventDefault();
                alert("Un lien de réinitialisation a été envoyé à votre email (simulé pour cette démo).");
            });
        }
        
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }
        
        function checkLoginStatus() {
            if (currentUser) {
                if (currentUser.email === ADMIN_CREDENTIALS.email) {
                    showAdminDashboard();
                } else {
                    showMainContent();
                }
                updateMenu();
            } else {
                showLogin();
            }
        }
        
        function updateMenu() {
            const isLoggedIn = currentUser !== null;
            const isAdmin = isLoggedIn && currentUser.email === ADMIN_CREDENTIALS.email;
            
            document.getElementById('loginLink').style.display = isLoggedIn ? 'none' : 'block';
            document.getElementById('registerLink').style.display = isLoggedIn ? 'none' : 'block';
            document.getElementById('logoutLink').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('dashboardLink').style.display = isLoggedIn ? 'block' : 'none';
            
            if (isAdmin) {
                document.getElementById('depositLink').style.display = 'none';
                document.getElementById('withdrawLink').style.display = 'none';
                document.getElementById('referralLink').style.display = 'none';
            } else {
                document.getElementById('depositLink').style.display = isLoggedIn ? 'block' : 'none';
                document.getElementById('withdrawLink').style.display = isLoggedIn ? 'block' : 'none';
                document.getElementById('referralLink').style.display = isLoggedIn ? 'block' : 'none';
            }
        }
        
        function showLogin() {
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('registerSection').style.display = 'none';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'none';
            document.getElementById('helpSection').style.display = 'none';
            
            // Reset alerts
            document.getElementById('loginAlert').style.display = 'none';
        }
        
        function showRegister() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('registerSection').style.display = 'block';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'none';
            document.getElementById('helpSection').style.display = 'none';
            
            // Reset alerts
            document.getElementById('registerAlert').style.display = 'none';
        }
        
        function showMainContent() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('registerSection').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('adminDashboard').style.display = 'none';
            document.getElementById('helpSection').style.display = 'none';
            
            // Update user info
            updateUserInfo();
            
            // Update referral link
            if (currentUser) {
                document.getElementById('referralLink').value = `https://galsenbusiness.com/?ref=${currentUser.id}`;
                document.getElementById('userGreeting').textContent = currentUser.name.split(' ')[0];
            }
        }
        
        function showAdminDashboard() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('registerSection').style.display = 'none';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'block';
            document.getElementById('helpSection').style.display = 'none';
            
            // Update admin stats
            updateAdminStats();
            
            // Load withdrawal requests
            loadWithdrawalRequests();
            
            // Load users list
            loadUsersList();
        }
        
        function showHelp() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('registerSection').style.display = 'none';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'none';
            document.getElementById('helpSection').style.display = 'block';
            
            // Activate first tab
            switchHelpTab('howItWorks');
        }
        
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('galsenBusinessDarkMode', document.body.classList.contains('dark-mode'));
        }
        
        function registerUser() {
            const name = document.getElementById('regName').value.trim();
            const email = document.getElementById('regEmail').value.trim().toLowerCase();
            const phone = document.getElementById('regPhone').value.trim();
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            const referralCode = document.getElementById('referralCode').value.trim();
            
            // Validate inputs
            if (!name || !email || !phone || !password || !confirmPassword) {
                showAlert('registerAlert', 'Tous les champs sont requis', 'error');
                return;
            }
            
            if (password.length < 6) {
                showAlert('registerAlert', 'Le mot de passe doit avoir au moins 6 caractères', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showAlert('registerAlert', 'Les mots de passe ne correspondent pas', 'error');
                return;
            }
            
            if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                showAlert('registerAlert', 'Numéro de téléphone Sénégalais invalide (doit commencer par 77, 76 ou 78 et contenir 9 chiffres)', 'error');
                return;
            }
            
            if (!validateEmail(email)) {
                showAlert('registerAlert', 'Adresse email invalide', 'error');
                return;
            }
            
            // Check if email already exists
            if (users.some(u => u.email === email)) {
                showAlert('registerAlert', 'Cet email est déjà utilisé', 'error');
                return;
            }
            
            // Check if phone already exists
            if (users.some(u => u.phone === phone)) {
                showAlert('registerAlert', 'Ce numéro de téléphone est déjà utilisé', 'error');
                return;
            }
            
            // Create new user
            const newUser = {
                id: Date.now().toString(),
                name,
                email,
                phone,
                password,
                balance: 0,
                level: 1,
                deposited: 0,
                referralCode: generateReferralCode(),
                referredBy: referralCode || null,
                referrals: [],
                earnings: [],
                createdAt: new Date()
            };
            
            users.push(newUser);
            currentUser = newUser;
            
            // Apply referral bonus if applicable
            if (referralCode) {
                applyReferralBonus(referralCode, newUser.id);
            }
            
            // Save data
            saveData();
            
            // Show success message
            showAlert('registerAlert', 'Inscription réussie ! Redirection en cours...', 'success');
            
            // Show main content after short delay
            setTimeout(() => {
                showMainContent();
                updateMenu();
            }, 1500);
        }
        
        function generateReferralCode() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }
        
        function applyReferralBonus(referralCode, newUserId) {
            // Find the referrer
            const referrer = users.find(u => u.referralCode === referralCode);
            if (referrer) {
                // Add this user to referrer's referrals
                referrer.referrals.push({
                    userId: newUserId,
                    date: new Date()
                });
                
                // If referrer has 10+ referrals, give 10% bonus on their next deposit
                if (referrer.referrals.length >= 10) {
                    referrer.hasReferralBonus = true;
                }
                
                // Save changes
                saveData();
            }
        }
        
        function loginUser() {
            const email = document.getElementById('loginEmail').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;
            
            // Find user
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                
                // Save to session
                sessionStorage.setItem('galsenBusinessCurrentUser', JSON.stringify(currentUser));
                
                // Check if admin
                if (email === ADMIN_CREDENTIALS.email) {
                    showAdminDashboard();
                } else {
                    showMainContent();
                }
                
                // Update menu
                updateMenu();
                
                // Reset error
                document.getElementById('loginAlert').style.display = 'none';
            } else {
                showAlert('loginAlert', 'Email ou mot de passe incorrect', 'error');
            }
        }
        
        function logoutUser() {
            currentUser = null;
            sessionStorage.removeItem('galsenBusinessCurrentUser');
            showLogin();
            updateMenu();
        }
        
        function updateUserInfo() {
            if (!currentUser) return;
            
            // Update balance and level
            document.getElementById('userBalance').textContent = `${currentUser.balance.toLocaleString()} XOF`;
            document.getElementById('userLevel').textContent = currentUser.level;
            
            // Update earning rates based on level
            const youtubeRate = systemSettings.earningRates[currentUser.level - 1] || 100;
            const tiktokRate = systemSettings.earningRates[currentUser.level - 1] || 100;
            
            document.getElementById('youtubeEarningRate').textContent = `${youtubeRate} XOF`;
            document.getElementById('tiktokEarningRate').textContent = `${tiktokRate} XOF`;
            
            // Calculate today's earnings
            const today = new Date().toDateString();
            const todayEarnings = currentUser.earnings
                .filter(e => new Date(e.date).toDateString() === today)
                .reduce((sum, e) => sum + e.amount, 0);
            
            document.getElementById('todayEarnings').textContent = `${todayEarnings.toLocaleString()} XOF`;
            
            // Update referral info
            document.getElementById('totalReferrals').textContent = currentUser.referrals.length;
            document.getElementById('referralLink').value = `https://galsenbusiness.com/?ref=${currentUser.referralCode}`;
            
            // Calculate referral earnings
            const referralEarnings = currentUser.referrals
                .map(ref => {
                    const referredUser = users.find(u => u.id === ref.userId);
                    return referredUser ? referredUser.deposited * 0.1 : 0;
                })
                .reduce((sum, amount) => sum + amount, 0);
            
            document.getElementById('referralEarnings').textContent = `${referralEarnings.toLocaleString()} XOF`;
            
            // Update video buttons based on watches
            updateVideoButtons();
            
            // Update referral list
            updateReferralList();
        }
        
        function updateVideoButtons() {
            if (videosWatched.youtube >= 1) {
                document.getElementById('youtubeBtn1').disabled = true;
                document.getElementById('youtubeBtn1').innerHTML = '<i class="fas fa-check-circle"></i> Déjà regardé';
                document.getElementById('youtubeStatus1').textContent = `+${systemSettings.earningRates[currentUser.level - 1] || 100} XOF gagnés`;
            }
            
            if (videosWatched.youtube >= 2) {
                document.getElementById('youtubeBtn2').disabled = true;
                document.getElementById('youtubeBtn2').innerHTML = '<i class="fas fa-check-circle"></i> Déjà regardé';
                document.getElementById('youtubeStatus2').textContent = `+${systemSettings.earningRates[currentUser.level - 1] || 100} XOF gagnés`;
            }
            
            if (videosWatched.tiktok >= 1) {
                document.getElementById('tiktokBtn').disabled = true;
                document.getElementById('tiktokBtn').innerHTML = '<i class="fas fa-check-circle"></i> Déjà regardé';
                document.getElementById('tiktokStatus').textContent = `+${systemSettings.earningRates[currentUser.level - 1] || 100} XOF gagnés`;
            }
        }
        
        function updateReferralList() {
            const referralList = document.getElementById('referralList');
            
            if (currentUser.referrals.length === 0) {
                referralList.innerHTML = '<p style="color: var(--gray); text-align: center;">Aucun filleul pour le moment</p>';
                return;
            }
            
            referralList.innerHTML = '';
            
            currentUser.referrals.forEach(ref => {
                const referredUser = users.find(u => u.id === ref.userId);
                if (referredUser) {
                    const item = document.createElement('div');
                    item.style.display = 'flex';
                    item.style.justifyContent = 'space-between';
                    item.style.padding = '8px 0';
                    item.style.borderBottom = '1px solid #eee';
                    
                    item.innerHTML = `
                        <div>
                            <strong>${referredUser.name}</strong>
                            <div style="font-size: 0.8rem; color: var(--gray);">${referredUser.email}</div>
                        </div>
                        <div style="text-align: right;">
                            <div>${new Date(ref.date).toLocaleDateString()}</div>
                            <div style="font-size: 0.8rem; color: var(--primary);">+${(referredUser.deposited * 0.1).toLocaleString()} XOF</div>
                        </div>
                    `;
                    
                    referralList.appendChild(item);
                }
            });
        }
        
        function updateAdminStats() {
            // Calculate total earnings (30% of all deposits)
            const totalEarnings = deposits.reduce((sum, deposit) => sum + (deposit.amount * 0.3), 0);
            document.getElementById('totalEarnings').textContent = `${totalEarnings.toLocaleString()} XOF`;
            
            // Total users
            document.getElementById('totalUsers').textContent = users.length;
            
            // Total transactions
            document.getElementById('totalTransactions').textContent = deposits.length + withdrawals.length;
            
            // Pending withdrawals
            const pendingWithdrawals = withdrawals.filter(w => w.status === 'pending').length;
            document.getElementById('pendingWithdrawals').textContent = pendingWithdrawals;
        }
        
        function loadWithdrawalRequests() {
            const pendingRequests = withdrawals.filter(w => w.status === 'pending');
            const tableBody = document.getElementById('withdrawalRequests');
            
            if (pendingRequests.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8" style="text-align: center;">Aucune demande de retrait en attente</td></tr>';
                return;
            }
            
            tableBody.innerHTML = pendingRequests.map(request => {
                const user = users.find(u => u.id === request.userId) || {};
                return `
                    <tr>
                        <td>${request.id.substring(0, 6)}</td>
                        <td>${user.name || 'Utilisateur inconnu'}</td>
                        <td>${request.amount.toLocaleString()} XOF</td>
                        <td>${request.method.toUpperCase()}</td>
                        <td>${request.phone}</td>
                        <td>${new Date(request.date).toLocaleString()}</td>
                        <td><span class="badge badge-pending">En attente</span></td>
                        <td>
                            <button onclick="approveWithdrawal('${request.id}')" class="btn" style="padding: 5px 10px;">
                                <i class="fas fa-check"></i> Approuver
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function loadUsersList() {
            const tableBody = document.getElementById('usersList');
            
            if (users.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8" style="text-align: center;">Aucun utilisateur trouvé</td></tr>';
                return;
            }
            
            tableBody.innerHTML = users.map(user => {
                return `
                    <tr>
                        <td>${user.id.substring(0, 6)}</td>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${user.phone}</td>
                        <td>${user.balance.toLocaleString()} XOF</td>
                        <td>${user.level}</td>
                        <td>${new Date(user.createdAt).toLocaleDateString()}</td>
                        <td>
                            <button onclick="viewUserDetails('${user.id}')" class="btn" style="padding: 5px 10px;">
                                <i class="fas fa-eye"></i> Voir
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function viewUserDetails(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            let details = `
                <h3>Détails de l'utilisateur</h3>
                <p><strong>Nom:</strong> ${user.name}</p>
                <p><strong>Email:</strong> ${user.email}</p>
                <p><strong>Téléphone:</strong> ${user.phone}</p>
                <p><strong>Solde:</strong> ${user.balance.toLocaleString()} XOF</p>
                <p><strong>Niveau:</strong> ${user.level}</p>
                <p><strong>Inscrit le:</strong> ${new Date(user.createdAt).toLocaleString()}</p>
                <p><strong>Total déposé:</strong> ${user.deposited.toLocaleString()} XOF</p>
                <p><strong>Filleuls:</strong> ${user.referrals.length}</p>
                
                <h4 style="margin-top: 20px;">Historique des transactions</h4>
            `;
            
            // Add deposits
            const userDeposits = deposits.filter(d => d.userId === userId);
            if (userDeposits.length > 0) {
                details += '<p><strong>Dépôts:</strong></p><ul>';
                userDeposits.forEach(deposit => {
                    details += `<li>${deposit.amount.toLocaleString()} XOF via ${deposit.method} - ${new Date(deposit.date).toLocaleString()}</li>`;
                });
                details += '</ul>';
            }
            
            // Add withdrawals
            const userWithdrawals = withdrawals.filter(w => w.userId === userId);
            if (userWithdrawals.length > 0) {
                details += '<p><strong>Retraits:</strong></p><ul>';
                userWithdrawals.forEach(withdrawal => {
                    details += `<li>${withdrawal.amount.toLocaleString()} XOF via ${withdrawal.method} - ${new Date(withdrawal.date).toLocaleString()} - <span class="badge ${withdrawal.status === 'completed' ? 'badge-success' : 'badge-pending'}">${withdrawal.status === 'completed' ? 'Complété' : 'En attente'}</span></li>`;
                });
                details += '</ul>';
            }
            
            alert(details);
        }
        
        function filterWithdrawals() {
            const searchTerm = document.getElementById('withdrawalSearch').value.toLowerCase();
            const rows = document.getElementById('withdrawalRequests').querySelectorAll('tr');
            
            rows.forEach(row => {
                if (row.cells.length < 2) return; // Skip header row
                
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }
        
        function filterUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const rows = document.getElementById('usersList').querySelectorAll('tr');
            
            rows.forEach(row => {
                if (row.cells.length < 2) return; // Skip header row
                
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }
        
        function updateDepositMethod() {
            const method = document.getElementById('depositMethod').value;
            
            document.getElementById('orangeDeposit').style.display = 'none';
            document.getElementById('waveDeposit').style.display = 'none';
            document.getElementById('freeDeposit').style.display = 'none';
            
            document.getElementById(`${method}Deposit`).style.display = 'block';
        }
        
        function updateWithdrawMethod() {
            const method = document.getElementById('withdrawMethod').value;
            
            document.getElementById('orangeWithdraw').style.display = 'none';
            document.getElementById('waveWithdraw').style.display = 'none';
            document.getElementById('freeWithdraw').style.display = 'none';
            
            document.getElementById(`${method}Withdraw`).style.display = 'block';
        }
        
        function updateAdminWithdrawMethod() {
            const method = document.getElementById('adminWithdrawMethod').value;
            
            document.getElementById('adminOrangeWithdraw').style.display = 'none';
            document.getElementById('adminWaveWithdraw').style.display = 'none';
            document.getElementById('adminFreeWithdraw').style.display = 'none';
            
            document.getElementById(`admin${method.charAt(0).toUpperCase() + method.slice(1)}Withdraw`).style.display = 'block';
        }
        
        function processDeposit(method) {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            
            if (!amount || amount < systemSettings.depositMin) {
                showAlert('depositStatus', `Le dépôt minimum est de ${systemSettings.depositMin.toLocaleString()} XOF`, 'error');
                return;
            }
            
            let phone, transactionId;
            if (method === 'orange') {
                phone = document.getElementById('orangeNumber').value.trim();
                if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                    showAlert('depositStatus', 'Numéro Orange Money Sénégalais invalide', 'error');
                    return;
                }
            } else if (method === 'wave') {
                transactionId = document.getElementById('waveTransactionId').value.trim();
                if (!transactionId) {
                    showAlert('depositStatus', 'ID de transaction Wave requis', 'error');
                    return;
                }
            } else if (method === 'free') {
                phone = document.getElementById('freeNumber').value.trim();
                if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                    showAlert('depositStatus', 'Numéro Free Money Sénégalais invalide', 'error');
                    return;
                }
            }
            
            // In a real app, you would verify the payment with the API here
            
            // Create deposit record
            const deposit = {
                id: Date.now().toString(),
                userId: currentUser.id,
                amount,
                method,
                phone: method !== 'wave' ? phone : null,
                transactionId: method === 'wave' ? transactionId : null,
                status: 'completed',
                adminEarnings: amount * 0.3, // 30% for admin
                date: new Date()
            };
            
            deposits.push(deposit);
            
            // Update user balance and level
            currentUser.balance += amount;
            currentUser.deposited += amount;
            
            // Check if user should level up
            updateUserLevel();
            
            // Apply referral bonus if applicable
            if (currentUser.hasReferralBonus) {
                const bonus = amount * 0.1; // 10% referral bonus
                currentUser.balance += bonus;
                currentUser.hasReferralBonus = false;
                
                // Add to earnings
                currentUser.earnings.push({
                    type: 'referral',
                    amount: bonus,
                    date: new Date(),
                    description: `Bonus de parrainage sur dépôt de ${amount.toLocaleString()} XOF`
                });
                
                showAlert('depositStatus', `Dépôt de ${amount.toLocaleString()} XOF effectué !<br>Bonus de parrainage: +${bonus.toLocaleString()} XOF`, 'success');
            } else {
                showAlert('depositStatus', `Dépôt de ${amount.toLocaleString()} XOF effectué !`, 'success');
            }
            
            // Add to earnings
            currentUser.earnings.push({
                type: 'deposit',
                amount: amount,
                date: new Date(),
                description: `Dépôt via ${method}`
            });
            
            // Save data
            saveData();
            
            // Update user info
            updateUserInfo();
            
            // If admin is viewing dashboard, update stats
            if (currentUser.email === ADMIN_CREDENTIALS.email) {
                updateAdminStats();
            }
            
            // Reset form
            document.getElementById('depositAmount').value = '';
            if (method === 'orange') {
                document.getElementById('orangeNumber').value = '';
            } else if (method === 'wave') {
                document.getElementById('waveTransactionId').value = '';
            } else if (method === 'free') {
                document.getElementById('freeNumber').value = '';
            }
        }
        
        function updateUserLevel() {
            const deposited = currentUser.deposited;
            let newLevel = 1;
            
            // Determine level based on deposited amount
            if (deposited >= 20000) newLevel = 10;
            else if (deposited >= 10000) newLevel = 9;
            else if (deposited >= 9000) newLevel = 8;
            else if (deposited >= 8000) newLevel = 7;
            else if (deposited >= 7000) newLevel = 6;
            else if (deposited >= 6000) newLevel = 5;
            else if (deposited >= 5000) newLevel = 4;
            else if (deposited >= 4000) newLevel = 3;
            else if (deposited >= 3000) newLevel = 2;
            
            if (newLevel > currentUser.level) {
                currentUser.level = newLevel;
                showAlert('depositStatus', `Félicitations ! Vous êtes maintenant niveau ${newLevel}`, 'success', true);
            }
        }
        
        function requestWithdrawal() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const method = document.getElementById('withdrawMethod').value;
            
            if (!amount || amount < systemSettings.withdrawMin) {
                showAlert('withdrawalStatus', `Le retrait minimum est de ${systemSettings.withdrawMin.toLocaleString()} XOF`, 'error');
                return;
            }
            
            if (amount > currentUser.balance) {
                showAlert('withdrawalStatus', 'Solde insuffisant', 'error');
                return;
            }
            
            let phone;
            if (method === 'orange') {
                phone = document.getElementById('withdrawOrangeNumber').value.trim();
                if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                    showAlert('withdrawalStatus', 'Numéro Orange Money Sénégalais invalide', 'error');
                    return;
                }
            } else if (method === 'wave') {
                phone = document.getElementById('withdrawWaveNumber').value.trim();
                if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                    showAlert('withdrawalStatus', 'Numéro Wave Sénégalais invalide', 'error');
                    return;
                }
            } else if (method === 'free') {
                phone = document.getElementById('withdrawFreeNumber').value.trim();
                if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                    showAlert('withdrawalStatus', 'Numéro Free Money Sénégalais invalide', 'error');
                    return;
                }
            }
            
            // Create withdrawal request
            const withdrawal = {
                id: Date.now().toString(),
                userId: currentUser.id,
                userName: currentUser.name,
                amount,
                method,
                phone,
                status: 'pending',
                date: new Date()
            };
            
            withdrawals.push(withdrawal);
            
            // Deduct from user balance
            currentUser.balance -= amount;
            
            // Add to earnings
            currentUser.earnings.push({
                type: 'withdrawal',
                amount: -amount,
                date: new Date(),
                description: `Demande de retrait via ${method}`
            });
            
            // Save data
            saveData();
            
            // Update user info
            updateUserInfo();
            
            showAlert('withdrawalStatus', `Demande de retrait de ${amount.toLocaleString()} XOF envoyée.<br>Le retrait sera traité dans les 24 heures.`, 'success');
            
            // Reset form
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawOrangeNumber').value = '';
            document.getElementById('withdrawWaveNumber').value = '';
            document.getElementById('withdrawFreeNumber').value = '';
            
            // If admin is logged in, update their view
            const adminUser = users.find(u => u.email === ADMIN_CREDENTIALS.email);
            if (adminUser && adminUser === currentUser) {
                loadWithdrawalRequests();
                updateAdminStats();
            }
        }
        
        function processAdminWithdrawal() {
            const amount = parseFloat(document.getElementById('adminWithdrawAmount').value);
            const method = document.getElementById('adminWithdrawMethod').value;
            
            if (!amount || amount < 1000) {
                showAlert('adminWithdrawStatus', 'Le retrait minimum est de 1 000 XOF', 'error');
                return;
            }
            
            let phone, transactionId;
            if (method === 'orange') {
                phone = document.getElementById('adminOrangeNumber').value.trim();
                if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                    showAlert('adminWithdrawStatus', 'Numéro Orange Money Sénégalais invalide', 'error');
                    return;
                }
            } else if (method === 'wave') {
                transactionId = document.getElementById('adminWaveTransactionId').value.trim();
                if (!transactionId) {
                    showAlert('adminWithdrawStatus', 'ID de transaction Wave requis', 'error');
                    return;
                }
            } else if (method === 'free') {
                phone = document.getElementById('adminFreeNumber').value.trim();
                if (!phone.match(/^[0-9]{9}$/) || !['77', '76', '78'].includes(phone.substring(0, 2))) {
                    showAlert('adminWithdrawStatus', 'Numéro Free Money Sénégalais invalide', 'error');
                    return;
                }
            }
            
            // In a real app, you would process the payment here
            
            // For demo, we'll simulate a successful withdrawal
            showAlert('adminWithdrawStatus', `Retrait de ${amount.toLocaleString()} XOF effectué via ${method.toUpperCase()}.<br>ID de transaction: ${Date.now()}`, 'success');
            
            // Reset form
            document.getElementById('adminWithdrawAmount').value = '';
            document.getElementById('adminOrangeNumber').value = '';
            document.getElementById('adminWaveTransactionId').value = '';
            document.getElementById('adminFreeNumber').value = '';
        }
        
        function approveWithdrawal(requestId) {
            const request = withdrawals.find(w => w.id === requestId);
            if (!request) return;
            
            // In a real app, you would process the payment to the user's phone number here
            // For demo, we'll just mark it as completed
            
            request.status = 'completed';
            request.processedAt = new Date();
            
            // Find the user
            const user = users.find(u => u.id === request.userId);
            if (user) {
                // Add transaction to user's earnings
                user.earnings.push({
                    type: 'withdrawal',
                    amount: -request.amount,
                    date: new Date(),
                    description: `Retrait approuvé via ${request.method}`
                });
            }
            
            // Save data
            saveData();
            
            // Update admin view
            loadWithdrawalRequests();
            updateAdminStats();
            
            alert(`Retrait de ${request.amount.toLocaleString()} XOF vers ${request.phone} approuvé !`);
        }
        
        function startWatchingVideo(platform, videoNumber) {
            if (!currentUser) return;
            
            // Check if user has made a deposit
            if (currentUser.deposited < systemSettings.depositMin) {
                alert(`Vous devez effectuer un dépôt minimum de ${systemSettings.depositMin.toLocaleString()} XOF pour regarder des vidéos`);
                document.getElementById('depositSection').scrollIntoView({ behavior: 'smooth' });
                return;
            }
            
            // Check daily limits
            if (platform === 'youtube' && videosWatched.youtube >= 2) {
                alert('Vous avez déjà regardé vos 2 vidéos YouTube aujourd\'hui');
                return;
            }
            
            if (platform === 'tiktok' && videosWatched.tiktok >= 1) {
                alert('Vous avez déjà regardé votre vidéo TikTok aujourd\'hui');
                return;
            }
            
            // Calculate earnings based on level
            const earningsPerVideo = systemSettings.earningRates[currentUser.level - 1] || 100;
            
            // Show video player
            const videoContainerId = `${platform}Video${platform === 'tiktok' ? '' : videoNumber}`;
            const videoContainer = document.getElementById(videoContainerId);
            
            // For demo, we'll just show a placeholder
            videoContainer.innerHTML = `
                <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: #000; color: white;">
                    <div style="text-align: center;">
                        <h3>${platform === 'youtube' ? 'YouTube' : 'TikTok'} Vidéo ${videoNumber || ''}</h3>
                        <p>Contenu de la vidéo simulé</p>
                    </div>
                </div>
            `;
            videoContainer.style.display = 'block';
            
            // For demo, we'll automatically complete after 5 seconds
            setTimeout(() => {
                completeVideoTask(platform, videoNumber, earningsPerVideo);
            }, 5000);
        }
        
        function completeVideoTask(platform, videoNumber, earnings) {
            // Update watch count
            videosWatched[platform]++;
            lastVideoDate = new Date();
            
            // Add to user balance
            currentUser.balance += earnings;
            
            // Add to earnings
            currentUser.earnings.push({
                type: 'video',
                amount: earnings,
                date: new Date(),
                description: `Vidéo ${platform === 'youtube' ? 'YouTube' : 'TikTok'} ${videoNumber || ''}`
            });
            
            // Save data
            saveData();
            
            // Update UI
            updateUserInfo();
            
            // Hide video player
            const videoContainerId = `${platform}Video${platform === 'tiktok' ? '' : videoNumber}`;
            document.getElementById(videoContainerId).style.display = 'none';
            
            // Show success message
            const platformName = platform === 'youtube' ? 'YouTube' : 'TikTok';
            alert(`Vous avez gagné ${earnings} XOF pour avoir regardé une vidéo ${platformName} !`);
        }
        
        function checkNewDay() {
            if (!lastVideoDate) return;
            
            const today = new Date();
            const lastDate = new Date(lastVideoDate);
            
            // Check if it's a new day
            if (today.getDate() !== lastDate.getDate() || 
                today.getMonth() !== lastDate.getMonth() || 
                today.getFullYear() !== lastDate.getFullYear()) {
                
                // Reset video counts
                videosWatched.youtube = 0;
                videosWatched.tiktok = 0;
                saveData();
                
                // Update video buttons
                updateVideoButtons();
            }
        }
        
        function copyReferralLink() {
            const referralLink = document.getElementById('referralLink');
            referralLink.select();
            document.execCommand('copy');
            
            // Show tooltip
            const tooltip = document.createElement('div');
            tooltip.textContent = 'Lien copié !';
            tooltip.style.position = 'fixed';
            tooltip.style.bottom = '20px';
            tooltip.style.right = '20px';
            tooltip.style.backgroundColor = 'var(--primary)';
            tooltip.style.color = 'white';
            tooltip.style.padding = '10px 15px';
            tooltip.style.borderRadius = '4px';
            tooltip.style.zIndex = '1000';
            document.body.appendChild(tooltip);
            
            setTimeout(() => {
                document.body.removeChild(tooltip);
            }, 2000);
        }
        
        function switchVideoTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            document.querySelector(`.tab:nth-child(${tab === 'youtube' ? 1 : 2})`).classList.add('active');
            document.getElementById(`${tab}Tab`).classList.add('active');
        }
        
        function switchHelpTab(tab) {
            document.querySelectorAll('#helpSection .tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('#helpSection .tab-content').forEach(c => c.classList.remove('active'));
            
            document.querySelector(`#helpSection .tab:nth-child(${tab === 'howItWorks' ? 1 : tab === 'faq' ? 2 : 3})`).classList.add('active');
            document.getElementById(`${tab}Tab`).classList.add('active');
        }
        
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            // Find the tab button that corresponds to this tab content
            const tabs = document.querySelectorAll('.tab');
            let tabIndex = -1;
            if (tabId === 'adminWithdrawTab') tabIndex = 0;
            else if (tabId === 'withdrawalRequestsTab') tabIndex = 1;
            else if (tabId === 'manageUsersTab') tabIndex = 2;
            else if (tabId === 'systemSettingsTab') tabIndex = 3;
            
            if (tabIndex >= 0 && tabs[tabIndex]) {
                tabs[tabIndex].classList.add('active');
            }
            
            document.getElementById(tabId).classList.add('active');
        }
        
        function toggleFaqAnswer(element) {
            const answer = element.nextElementSibling;
            const icon = element.querySelector('i');
            
            if (answer.style.display === 'none' || !answer.style.display) {
                answer.style.display = 'block';
                icon.classList.replace('fa-chevron-right', 'fa-chevron-down');
            } else {
                answer.style.display = 'none';
                icon.classList.replace('fa-chevron-down', 'fa-chevron-right');
            }
        }
        
        function toggleAutoWithdraw() {
            const enabled = document.getElementById('autoWithdrawEnabled').checked;
            document.getElementById('autoWithdrawSettings').style.display = enabled ? 'block' : 'none';
            
            // Load current settings if enabled
            if (enabled) {
                document.getElementById('autoWithdrawMinAmount').value = systemSettings.autoWithdrawMin || 500;
                document.getElementById('autoWithdrawMaxAmount').value = systemSettings.autoWithdrawMax || 50000;
                document.getElementById('autoWithdrawPhone').value = systemSettings.autoWithdrawPhone || '';
            }
        }
        
        function saveAutoWithdrawSettings() {
            systemSettings.autoWithdraw = document.getElementById('autoWithdrawEnabled').checked;
            systemSettings.autoWithdrawMin = parseInt(document.getElementById('autoWithdrawMinAmount').value) || 500;
            systemSettings.autoWithdrawMax = parseInt(document.getElementById('autoWithdrawMaxAmount').value) || 50000;
            systemSettings.autoWithdrawPhone = document.getElementById('autoWithdrawPhone').value.trim();
            
            saveData();
            showAlert('autoWithdrawStatus', 'Paramètres de retrait automatique enregistrés', 'success');
        }
        
        function loadSystemSettings() {
            // Load earning rates
            const earningRatesContainer = document.getElementById('earningRates');
            earningRatesContainer.innerHTML = '';
            
            systemSettings.earningRates.forEach((rate, index) => {
                const div = document.createElement('div');
                div.style.marginBottom = '10px';
                
                div.innerHTML = `
                    <label>Niveau ${index + 1}</label>
                    <input type="number" value="${rate}" onchange="updateEarningRate(${index}, this.value)" style="width: 100%;">
                `;
                
                earningRatesContainer.appendChild(div);
            });
            
            // Load other settings
            document.getElementById('depositMinAmount').value = systemSettings.depositMin || 1000;
            document.getElementById('withdrawMinAmount').value = systemSettings.withdrawMin || 500;
            
            // Load auto withdraw settings
            document.getElementById('autoWithdrawEnabled').checked = systemSettings.autoWithdraw || false;
            toggleAutoWithdraw();
        }
        
        function updateEarningRate(levelIndex, value) {
            systemSettings.earningRates[levelIndex] = parseInt(value) || 100;
            saveData();
        }
        
        function saveSystemSettings() {
            systemSettings.depositMin = parseInt(document.getElementById('depositMinAmount').value) || 1000;
            systemSettings.withdrawMin = parseInt(document.getElementById('withdrawMinAmount').value) || 500;
            
            saveData();
            showAlert('systemSettingsStatus', 'Paramètres système enregistrés', 'success');
        }
        
        function showAlert(elementId, message, type, append = false) {
            const alertElement = document.getElementById(elementId);
            
            if (!append) {
                alertElement.innerHTML = '';
            }
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                         type === 'error' ? 'fa-exclamation-circle' : 
                         'fa-info-circle';
            
            const alertClass = type === 'success' ? 'alert-success' : 
                              type === 'error' ? 'alert-error' : 
                              'alert-warning';
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert ${alertClass}`;
            alertDiv.innerHTML = `
                <i class="fas ${icon}"></i>
                <div>${message}</div>
            `;
            
            if (append) {
                alertElement.appendChild(alertDiv);
            } else {
                alertElement.innerHTML = alertDiv.innerHTML;
                alertElement.style.display = 'flex';
            }
            
            // Auto-hide after 5 seconds
            if (!append) {
                setTimeout(() => {
                    alertElement.style.display = 'none';
                }, 5000);
            }
        }
        
        function saveData() {
            // Save to localStorage (replace with database in production)
            localStorage.setItem('galsenBusinessUsers', JSON.stringify(users));
            localStorage.setItem('galsenBusinessDeposits', JSON.stringify(deposits));
            localStorage.setItem('galsenBusinessWithdrawals', JSON.stringify(withdrawals));
            localStorage.setItem('galsenBusinessVideosWatched', JSON.stringify(videosWatched));
            localStorage.setItem('galsenBusinessSettings', JSON.stringify(systemSettings));
            
            if (lastVideoDate) {
                localStorage.setItem('galsenBusinessLastVideoDate', lastVideoDate.toISOString());
            }
            
            if (currentUser) {
                sessionStorage.setItem('galsenBusinessCurrentUser', JSON.stringify(currentUser));
            }
        }
        
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
    </script>
</body>
</html>
